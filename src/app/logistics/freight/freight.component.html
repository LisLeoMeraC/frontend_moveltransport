<p-toast></p-toast>

<p-toolbar styleClass="p-toolbar p-component mb-0 py-2">
    <h3 class="m-0 flex align-items-center">Fletes</h3>
</p-toolbar>

<div class="card mt-4 w-full">
    <!-- Filtros -->
    <div class="flex flex-wrap gap-4 p-4 border-b">
        <div class="flex flex-col gap-1 min-w-0">
            <label for="filterSerialReference" class="text-sm font-medium">Serial / Referencia</label>
            <input pInputText id="filterSerialReference" [(ngModel)]="filters().serialReference" placeholder="Buscar por serial..." class="w-full" />
        </div>
        <div class="flex flex-col gap-1 min-w-0">
            <label for="filterFreightType" class="text-sm font-medium">Tipo de Flete</label>
            <p-select id="filterFreightType" [options]="freightTypes" optionLabel="label" optionValue="value" [(ngModel)]="filters().freightType" placeholder="Todos" [showClear]="true" [appendTo]="'body'" class="w-full"></p-select>
        </div>
        <div class="flex flex-col gap-1 min-w-0">
            <label for="filterFreightStatus" class="text-sm font-medium">Estado Flete</label>
            <p-select id="filterFreightStatus" [options]="freightStatuses" optionLabel="label" optionValue="value" [(ngModel)]="filters().freightStatus" placeholder="Todos" [showClear]="true" [appendTo]="'body'" class="w-full"></p-select>
        </div>
        <div class="flex flex-col gap-1 min-w-0">
            <label for="filterStartDate" class="text-sm font-medium">Fecha Desde</label>
            <p-datepicker id="filterStartDate" [(ngModel)]="filters().startDate" dateFormat="dd/mm/yy" [showIcon]="true" placeholder="Seleccione fecha" [appendTo]="'body'"></p-datepicker>
        </div>
        <div class="flex flex-col gap-1 min-w-0">
            <label for="filterEndDate" class="text-sm font-medium">Fecha Hasta</label>
            <p-datepicker id="filterEndDate" [(ngModel)]="filters().endDate" dateFormat="dd/mm/yy" [showIcon]="true" placeholder="Seleccione fecha" [appendTo]="'body'"></p-datepicker>
        </div>
        <div class="flex flex-col gap-1 min-w-0">
            <label for="filterOriginCity" class="text-sm font-medium">Ciudad Origen</label>
            <input pInputText id="filterOriginCity" [(ngModel)]="filters().originCity" placeholder="Buscar ciudad origen..." class="w-full" />
        </div>
        <div class="flex flex-col gap-1 min-w-0">
            <label for="filterDestinationCity" class="text-sm font-medium">Ciudad Destino</label>
            <input pInputText id="filterDestinationCity" [(ngModel)]="filters().destinationCity" placeholder="Buscar ciudad destino..." class="w-full" />
        </div>
        <div class="flex flex-col gap-4 items-end">
            <button pButton label="Filtrar" icon="pi pi-filter" (click)="applyFilters()" class="p-button-primary"></button>
            <button pButton label="Limpiar" icon="pi pi-times" (click)="clearFilters()" class="p-button-secondary"></button>
        </div>
    </div>

    <p-table [scrollable]="true" scrollHeight="550px" scrollDirection="both" styleClass="mt-4 w-full" [value]="freightService.freightsList()" [loading]="freightService.isLoading()">
        <ng-template #caption>
            <div class="flex justify-between items-center flex-column sm:flex-row gap-3">
                <button pButton label="Agregar" icon="pi pi-plus" (click)="openDialogFreight()"></button>

                <p-iconfield iconPosition="left" class="ml-auto">
                    <p-inputicon>
                        <i class="pi pi-search"></i>
                    </p-inputicon>
                    <input pInputText type="text" placeholder="Buscar..." [(ngModel)]="searchTerm" />
                </p-iconfield>
            </div>
        </ng-template>

        <ng-template pTemplate="header">
            <tr>
                <th>Serial / Referencia</th>
                <th>Tipo</th>
                <th>Estado Flete</th>
                <th>Estado Pago</th>
                <th>Fecha Solicitada</th>
                <th>Unidades</th>
                <th>Tipo Carga</th>
                <th>Origen</th>
                <th>Destino</th>
                <th>Acciones</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-freight>
            <tr>
                <td>{{ freight.serialReference }}</td>
                <td>
                    <p-tag
                        [value]="freight.type === 'export' ? 'Exportación' : freight.type === 'import' ? 'Importación' : freight.type === 'internal' ? 'Interno' : 'Rescate'"
                        [severity]="freight.type === 'export' ? 'info' : freight.type === 'import' ? 'success' : 'warning'"
                    >
                    </p-tag>
                </td>
                <td>
                    <p-tag
                        [value]="
                            freight.freightStatus === 'pending'
                                ? 'Pendiente'
                                : freight.freightStatus === 'in_transit'
                                  ? 'En Tránsito'
                                  : freight.freightStatus === 'delayed'
                                    ? 'Retrasado'
                                    : freight.freightStatus === 'completed'
                                      ? 'Completado'
                                      : 'Cancelado'
                        "
                        [severity]="getStatusSeverity(freight.freightStatus)"
                    >
                    </p-tag>
                </td>
                <td>
                    <p-tag
                        [value]="freight.paymentStatus === 'pending' ? 'Pendiente' : freight.paymentStatus === 'paid' ? 'Pagado' : 'Vencido'"
                        [severity]="freight.paymentStatus === 'pending' ? 'warning' : freight.paymentStatus === 'paid' ? 'success' : 'danger'"
                    >
                    </p-tag>
                </td>
                <td>{{ freight.requestedDate | date: 'dd/MM/yyyy' }}</td>
                <td>{{ freight.requestedUnits }}</td>
                <td>{{ freight.cargoUnitType }}</td>
                <td>{{ freight.origin?.name || freight.originReference }}</td>
                <td>{{ freight.destination?.name || freight.destinationReference }}</td>
                <td class="text-center">
                    <a pButton
                       label="Ver detalles"
                       severity="secondary"
                       class="p-button p-button-bg p-button-ro"
                       [routerLink]="[freight.id]"
                       icon="pi pi-eye"
                       iconPos="left">
                    </a>
                </td>
            </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
            <tr>
                <td colspan="10" class="text-center">No hay fletes registrados.</td>
            </tr>
        </ng-template>
    </p-table>

    <p-paginator
        [rows]="pageSize()"
        [first]="(freightService.paginationData().currentPage - 1) * pageSize()"
        [totalRecords]="freightService.paginationData().totalRecords"
        [rowsPerPageOptions]="[5, 10, 25, 100]"
        (onPageChange)="onPageChange($event)"
        styleClass="dark-paginator"
    ></p-paginator>
</div>

<p-dialog header="Registrar Flete" [(visible)]="dialogFreight" [modal]="true" [style]="{ width: '50vw' }" [breakpoints]="{ '960px': '90vw' }" [closable]="true" (onHide)="closeDialogFreight()">
    <form [formGroup]="freightForm" (ngSubmit)="onSubmitFreight()">
        <!-- Stepper personalizado -->
        <div class="stepper-container mb-4">
            <div class="stepper-nav">
                <div class="stepper-item" [class.active]="currentStep === 1" [class.completed]="currentStep > 1">
                    <div class="stepper-number">1</div>
                    <div class="stepper-title">Cliente</div>
                </div>
                <div class="stepper-separator"></div>
                <div class="stepper-item" [class.active]="currentStep === 2" [class.completed]="currentStep > 2">
                    <div class="stepper-number">2</div>
                    <div class="stepper-title">Carga</div>
                </div>
                <div class="stepper-separator"></div>
                <div class="stepper-item" [class.active]="currentStep === 3" [class.completed]="currentStep > 3">
                    <div class="stepper-number">3</div>
                    <div class="stepper-title">Origen y Destino</div>
                </div>
                <div class="stepper-separator"></div>
                <div class="stepper-item" [class.active]="currentStep === 4" [class.completed]="currentStep > 4">
                    <div class="stepper-number">4</div>
                    <div class="stepper-title">Resumen</div>
                </div>
            </div>
        </div>

        <!-- Contenido de los pasos -->
        <div class="stepper-content">
            <!-- Paso 1: Datos del Cliente -->
            <div *ngIf="currentStep === 1" class="step-content">
                <h4 class="step-header">Datos del Cliente</h4>
                <div class="flex flex-col gap-4">
                    <div class="flex flex-wrap gap-4">
                        <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                            <label for="client" class="text-sm">Cliente <span class="text-red-500">*</span></label>
                            <p-select id="client" formControlName="client" [options]="clients()" optionLabel="label" optionValue="value" placeholder="Seleccione un cliente" [showClear]="true" [appendTo]="'body'">
                                <ng-template pTemplate="header">
                                    <div class="p-2">
                                        <input type="text" pInputText placeholder="Buscar cliente..." [(ngModel)]="clientSearchTerm" (ngModelChange)="onClientSearchChange()" [ngModelOptions]="{ standalone: true }" class="w-full" />
                                    </div>
                                </ng-template>
                                <ng-template pTemplate="footer">
                                    <div class="p-2 border-t">
                                        <p-paginator [first]="(clientsPage() - 1) * clientsPageSize" [rows]="clientsPageSize" [totalRecords]="clientsTotalRecords()" (onPageChange)="onClientsPageChange($event)"></p-paginator>
                                    </div>
                                </ng-template>
                            </p-select>
                        </div>
                        <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                            <label for="freightType" class="text-sm">Tipo de Flete <span class="text-red-500">*</span></label>
                            <p-select id="freightType" formControlName="freightType" [options]="freightTypes" optionLabel="label" optionValue="value" placeholder="Seleccione tipo de flete" [showClear]="true" [appendTo]="'body'"></p-select>
                        </div>
                    </div>
                    <div class="flex flex-wrap gap-4">
                        <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                            <label for="serialReference" class="text-sm">Número de Lote</label>
                            <input pInputText id="serialReference" formControlName="serialReference" maxlength="25" placeholder="Ingrese el número de lote del flete" />
                        </div>
                        <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                            <label for="requestedDate" class="text-sm">Fecha Solicitada <span class="text-red-500">*</span></label>
                            <p-datepicker id="requestedDate" formControlName="requestedDate" dateFormat="dd/mm/yy" [showIcon]="true" placeholder="Seleccione fecha" [appendTo]="'body'"></p-datepicker>
                        </div>
                    </div>
                </div>
                <div class="flex justify-end mt-4">
                    <button pButton label="Siguiente" icon="pi pi-arrow-right" iconPos="right" type="button" (click)="nextStep()"></button>
                </div>
            </div>

            <!-- Paso 2: Carga -->
            <div *ngIf="currentStep === 2" class="step-content">
                <h4 class="step-header">Información de Carga</h4>
                <div class="flex flex-col gap-4">
                    <div class="flex flex-wrap gap-4">
                        <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                            <label for="unitsRequired" class="text-sm">Nº unidades requeridas <span class="text-red-500">*</span></label>
                            <input pInputText id="unitsRequired" formControlName="unitsRequired" type="number" min="1" placeholder="Ingrese número de unidades" />
                        </div>
                        <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                            <label for="cargoUnitType" class="text-sm">Tipo de unidad de carga <span class="text-red-500">*</span></label>
                            <p-select id="cargoUnitType" formControlName="cargoUnitType" [options]="cargoUnitTypes" optionLabel="label" optionValue="value" placeholder="Seleccione tipo de unidad" [showClear]="true" [appendTo]="'body'"></p-select>
                        </div>
                    </div>
                    <div class="flex flex-wrap gap-4">
                        <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                            <label for="cargoCondition" class="text-sm">Condición de la carga <span class="text-red-500">*</span></label>
                            <p-select id="cargoCondition" formControlName="cargoCondition" [options]="cargoConditions" optionLabel="label" optionValue="value" placeholder="Seleccione condición" [showClear]="true" [appendTo]="'body'"></p-select>
                        </div>
                    </div>
                    <div class="flex flex-wrap gap-4">
                        <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                            <label for="observations" class="text-sm">Observaciones</label>
                            <textarea pTextarea id="observations" formControlName="observations" rows="4" maxlength="250" placeholder="Ingrese observaciones adicionales (máximo 250 caracteres)"></textarea>
                            <small class="text-gray-500">{{ freightForm.get('observations')?.value?.length || 0 }}/250 caracteres</small>
                        </div>
                        <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                            <label for="cargoDescription" class="text-sm">Descripción de la carga</label>
                            <textarea pTextarea id="cargoDescription" formControlName="cargoDescription" rows="4" maxlength="250" placeholder="Describa la carga (máximo 250 caracteres)"></textarea>
                            <small class="text-gray-500">{{ freightForm.get('cargoDescription')?.value?.length || 0 }}/250 caracteres</small>
                        </div>
                    </div>
                </div>
                <div class="flex justify-between mt-4">
                    <button pButton label="Anterior" icon="pi pi-arrow-left" type="button" (click)="previousStep()" class="p-button-secondary"></button>
                    <button pButton label="Siguiente" icon="pi pi-arrow-right" iconPos="right" type="button" (click)="nextStep()"></button>
                </div>
            </div>

            <!-- Paso 3: Origen y Destino -->
            <div *ngIf="currentStep === 3" class="step-content">
                <h4 class="step-header">Origen y Destino</h4>
                <div class="flex flex-col gap-4">
                    <!-- Origen -->
                    <div class="border border-gray-200 rounded-lg p-4">
                        <h5 class="text-base font-semibold text-gray-700 mb-3">Origen</h5>
                        <div class="flex flex-wrap gap-4">
                            <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                                <label for="originProvince" class="text-sm">Provincia de origen <span class="text-red-500">*</span></label>
                                <p-select
                                    id="originProvince"
                                    [options]="provinces()"
                                    formControlName="originProvince"
                                    optionLabel="name"
                                    [optionValue]="'id'"
                                    placeholder="Seleccione provincia"
                                    [loading]="isLoading()"
                                    [showClear]="true"
                                    [filter]="true"
                                    [appendTo]="'body'"
                                    class="w-full custom-select"
                                    (onChange)="onProvinceOriginChange($event)"
                                ></p-select>
                            </div>
                            <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                                <label for="originCity" class="text-sm">Ciudad de origen <span class="text-red-500">*</span></label>
                                <p-select
                                    id="originCity"
                                    [options]="originCities()"
                                    formControlName="originCity"
                                    optionLabel="name"
                                    [optionValue]="'id'"
                                    placeholder="Seleccione ciudad"
                                    [showClear]="true"
                                    [appendTo]="'body'"
                                    [filter]="true"
                                    filterPlaceholder="Buscar ciudad"
                                    [loading]="isLoading()"
                                    class="w-full custom-select"
                                ></p-select>
                            </div>
                        </div>
                        <div class="flex flex-wrap gap-4 mt-3">
                            <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                                <label for="originReference" class="text-sm">Referencia origen</label>
                                <input pInputText id="originReference" formControlName="originReference" placeholder="Dirección exacta, punto de referencia, etc." />
                            </div>
                            <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                                <label for="originDepot" class="text-sm">Depósito de retiro</label>
                                <p-select
                                    id="originDepot"
                                    [options]="depots()"
                                    [appendTo]="'body'"
                                    [filter]="true"
                                    filterPlaceholder="Buscar depósito"
                                    formControlName="originDepot"
                                    optionLabel="name"
                                    optionValue="id"
                                    placeholder="Seleccione depósito"
                                    [showClear]="true"
                                ></p-select>
                            </div>
                        </div>
                    </div>

                    <!-- Destino -->
                    <div class="border border-gray-200 rounded-lg p-4">
                        <h5 class="text-base font-semibold text-gray-700 mb-3">Destino</h5>
                        <div class="flex flex-wrap gap-4">
                            <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                                <label for="destinationProvince" class="text-sm">Provincia de destino <span class="text-red-500">*</span></label>
                                <p-select
                                    id="destinationProvince"
                                    [options]="provinces()"
                                    formControlName="destinationProvince"
                                    optionLabel="name"
                                    [optionValue]="'id'"
                                    placeholder="Seleccione provincia"
                                    [loading]="isLoading()"
                                    [showClear]="true"
                                    [filter]="true"
                                    [appendTo]="'body'"
                                    class="w-full custom-select"
                                    (onChange)="onProvinceDestinChange($event)"
                                ></p-select>
                            </div>
                            <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                                <label for="destinationCity" class="text-sm">Ciudad de destino <span class="text-red-500">*</span></label>
                                <p-select
                                    id="destinationCity"
                                    [options]="destinationCities()"
                                    formControlName="destinationCity"
                                    optionLabel="name"
                                    [optionValue]="'id'"
                                    placeholder="Seleccione ciudad"
                                    [showClear]="true"
                                    [appendTo]="'body'"
                                    [filter]="true"
                                    filterPlaceholder="Buscar ciudad"
                                    [loading]="isLoading()"
                                    class="w-full custom-select"
                                ></p-select>
                            </div>
                        </div>
                        <div class="flex flex-wrap gap-4 mt-3">
                            <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                                <label for="destinationReference" class="text-sm">Referencia destino</label>
                                <input pInputText id="destinationReference" formControlName="destinationReference" placeholder="Dirección exacta, punto de referencia, etc." />
                            </div>
                            <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                                <label for="destinationDepot" class="text-sm">Depósito de entrega</label>
                                <p-select
                                    id="destinationDepot"
                                    [options]="depots()"
                                    [appendTo]="'body'"
                                    [filter]="true"
                                    filterPlaceholder="Buscar depósito"
                                    formControlName="destinationDepot"
                                    optionLabel="name"
                                    optionValue="id"
                                    placeholder="Seleccione depósito"
                                    [showClear]="true"
                                ></p-select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="flex justify-between mt-4">
                    <button pButton label="Anterior" icon="pi pi-arrow-left" type="button" (click)="previousStep()" class="p-button-secondary"></button>
                    <button pButton label="Siguiente" icon="pi pi-arrow-right" iconPos="right" type="button" (click)="nextStep()"></button>
                </div>
            </div>

            <!-- Paso 4: Resumen y Documentos -->
            <div *ngIf="currentStep === 4" class="step-content">
                <h4 class="step-header">Resumen</h4>

                <div class="flex flex-col gap-4">
                    <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-3 dark:bg-gray-900/40">
                        <div class="flex items-center justify-between gap-3 mb-2">
                            <h5 class="text-sm font-semibold text-gray-700 dark:text-gray-100 m-0">Detalle del Flete</h5>
                            <span class="text-xs text-gray-500 dark:text-gray-400">Revisa antes de registrar</span>
                        </div>

                        <div class="flex flex-wrap gap-2">
                            <span class="inline-flex items-center gap-2 text-xs bg-gray-50 dark:bg-gray-900/70 text-gray-700 dark:text-gray-200 border border-gray-200 dark:border-gray-700 rounded-full px-3 py-1 min-w-0 max-w-full">
                                <span class="text-gray-500 dark:text-gray-400">Cliente:</span>
                                <span class="font-semibold truncate">{{ getClientName(freightForm.get('client')?.value) }}</span>
                            </span>

                            <span *ngIf="freightForm.get('serialReference')?.value" class="inline-flex items-center gap-2 text-xs bg-gray-50 dark:bg-gray-900/70 text-gray-700 dark:text-gray-200 border border-gray-200 dark:border-gray-700 rounded-full px-3 py-1 min-w-0 max-w-full">
                                <span class="text-gray-500 dark:text-gray-400">Ref:</span>
                                <span class="font-semibold truncate">{{ freightForm.get('serialReference')?.value }}</span>
                            </span>

                            <span class="inline-flex items-center gap-2 text-xs bg-gray-50 dark:bg-gray-900/70 text-gray-700 dark:text-gray-200 border border-gray-200 dark:border-gray-700 rounded-full px-3 py-1">
                                <span class="text-gray-500 dark:text-gray-400">Fecha:</span>
                                <span class="font-semibold">{{ freightForm.get('requestedDate')?.value | date: 'dd/MM/yyyy' }}</span>
                            </span>

                            <span class="inline-flex items-center gap-2 text-xs bg-gray-50 dark:bg-gray-900/70 text-gray-700 dark:text-gray-200 border border-gray-200 dark:border-gray-700 rounded-full px-3 py-1">
                                <span class="text-gray-500 dark:text-gray-400">Unidades:</span>
                                <span class="font-semibold">{{ freightForm.get('unitsRequired')?.value }}</span>
                            </span>

                            <span class="inline-flex items-center gap-2 text-xs bg-gray-50 dark:bg-gray-900/70 text-gray-700 dark:text-gray-200 border border-gray-200 dark:border-gray-700 rounded-full px-3 py-1 min-w-0 max-w-full">
                                <span class="text-gray-500 dark:text-gray-400">Ruta:</span>
                                <span class="font-semibold truncate">{{ getCityName(freightForm.get('originCity')?.value) }}</span>
                                <span class="text-gray-400 dark:text-gray-500">→</span>
                                <span class="font-semibold truncate">{{ getCityName(freightForm.get('destinationCity')?.value) }}</span>
                            </span>
                        </div>
                    </div>

                    <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-3 dark:bg-gray-900/40">
                        <div class="flex items-center justify-between gap-3 mb-2">
                            <div class="min-w-0">
                                <h5 class="text-sm font-semibold text-gray-700 dark:text-gray-100 m-0">Archivos (opcional)</h5>
                                <div class="text-xs text-gray-500 dark:text-gray-400">Adjunta PDF/imagen/documentos (máx 5MB c/u).</div>
                            </div>
                            <div class="shrink-0 flex items-center gap-2">
                                <span *ngIf="selectedFiles.length" class="inline-flex items-center text-xs bg-gray-50 dark:bg-gray-900/70 text-gray-700 dark:text-gray-200 border border-gray-200 dark:border-gray-700 rounded-full px-2 py-1">
                                    {{ selectedFiles.length }} seleccionado(s)
                                </span>
                                <button *ngIf="selectedFiles.length" pButton type="button" label="Limpiar" class="p-button-text p-button-sm" (click)="onFilesClear()"></button>
                            </div>
                        </div>

                        <div class="rounded-md border border-dashed border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/60 p-3">
                            <p-fileupload
                                name="files[]"
                                styleClass="fileupload-dropzone"
                                [multiple]="true"
                                [customUpload]="true"
                                [showUploadButton]="false"
                                [showCancelButton]="false"
                                chooseLabel="Explorar archivos"
                                accept="image/*,.pdf,.doc,.docx,.xls,.xlsx,.csv"
                                [maxFileSize]="5000000"
                                (onSelect)="onFilesSelect($event)"
                                (onClear)="onFilesClear()"
                            >
                                <ng-template pTemplate="content">
                                    <div class="dropzone-area flex flex-col items-center justify-center text-center py-8 px-3 gap-4">
                                        <i class="pi pi-cloud-upload text-5xl text-gray-300"></i>
                                        <div class="text-2xl font-semibold text-gray-400 dark:text-gray-300">Arrastra y suelta archivos aquí</div>
                                        <div class="text-sm text-gray-400 dark:text-gray-400">o</div>
                                        <div class="text-xs text-gray-500 dark:text-gray-400">PDF/imagen/documentos (máx 5MB c/u).</div>
                                    </div>

                                    <div *ngIf="selectedFiles.length" class="mt-3 border border-gray-100 dark:border-gray-700 rounded-md bg-white dark:bg-gray-950/40 max-h-40 overflow-auto">
                                        <div *ngFor="let f of selectedFiles" class="flex items-center justify-between gap-3 px-3 py-2 border-b border-gray-100 dark:border-gray-800 last:border-b-0">
                                            <div class="min-w-0">
                                                <div class="text-sm text-gray-800 dark:text-gray-100 truncate">{{ f.name }}</div>
                                                <div class="text-xs text-gray-500 dark:text-gray-400">{{ formatFileSize(f.size) }}</div>
                                            </div>
                                            <button pButton type="button" icon="pi pi-times" class="p-button-text p-button-sm p-button-danger" (click)="removeSelectedFile(f)"></button>
                                        </div>
                                    </div>
                                </ng-template>
                            </p-fileupload>
                        </div>
                    </div>
                </div>

                <div class="flex justify-between mt-4">
                    <button pButton label="Anterior" icon="pi pi-arrow-left" type="button" (click)="previousStep()" class="p-button-secondary"></button>
                    <button pButton label="Registrar" icon="pi pi-save" type="submit"></button>
                </div>
            </div>
        </div>
    </form>
</p-dialog>


