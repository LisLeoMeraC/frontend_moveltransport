<p-toast></p-toast>

<p-toolbar styleClass="p-toolbar p-component mb-0 py-2">
    <h3 class="m-0 flex align-items-center">Fletes</h3>
</p-toolbar>

<div class="card mt-4 w-full">
    <!-- Filtros -->
    <div class="flex flex-wrap gap-4 p-4 border-b">
        <div class="flex flex-col gap-1 min-w-0">
            <label for="filterSerialReference" class="text-sm font-medium">Serial / Referencia</label>
            <input pInputText id="filterSerialReference" [(ngModel)]="filters().serialReference" placeholder="Buscar por serial..." class="w-full" />
        </div>
        <div class="flex flex-col gap-1 min-w-0">
            <label for="filterFreightType" class="text-sm font-medium">Tipo de Flete</label>
            <p-dropdown id="filterFreightType" [options]="freightTypes" optionLabel="label" optionValue="value" [(ngModel)]="filters().freightType" placeholder="Todos" [showClear]="true" appendTo="body" class="w-full"></p-dropdown>
        </div>
        <div class="flex flex-col gap-1 min-w-0">
            <label for="filterFreightStatus" class="text-sm font-medium">Estado Flete</label>
            <p-dropdown id="filterFreightStatus" [options]="freightStatuses" optionLabel="label" optionValue="value" [(ngModel)]="filters().freightStatus" placeholder="Todos" [showClear]="true" appendTo="body" class="w-full"></p-dropdown>
        </div>
        <div class="flex flex-col gap-1 min-w-0">
            <label for="filterStartDate" class="text-sm font-medium">Fecha Desde</label>
            <p-calendar id="filterStartDate" [(ngModel)]="filters().startDate" dateFormat="dd/mm/yy" [showIcon]="true" placeholder="Seleccione fecha" appendTo="body"></p-calendar>
        </div>
        <div class="flex flex-col gap-1 min-w-0">
            <label for="filterEndDate" class="text-sm font-medium">Fecha Hasta</label>
            <p-calendar id="filterEndDate" [(ngModel)]="filters().endDate" dateFormat="dd/mm/yy" [showIcon]="true" placeholder="Seleccione fecha" appendTo="body"></p-calendar>
        </div>
        <div class="flex flex-col gap-1 min-w-0">
            <label for="filterOriginCity" class="text-sm font-medium">Ciudad Origen</label>
            <input pInputText id="filterOriginCity" [(ngModel)]="filters().originCity" placeholder="Buscar ciudad origen..." class="w-full" />
        </div>
        <div class="flex flex-col gap-1 min-w-0">
            <label for="filterDestinationCity" class="text-sm font-medium">Ciudad Destino</label>
            <input pInputText id="filterDestinationCity" [(ngModel)]="filters().destinationCity" placeholder="Buscar ciudad destino..." class="w-full" />
        </div>
        <div class="flex flex-col gap-4 items-end">
            <button pButton label="Filtrar" icon="pi pi-filter" (click)="applyFilters()" class="p-button-primary"></button>
            <button pButton label="Limpiar" icon="pi pi-times" (click)="clearFilters()" class="p-button-secondary"></button>
        </div>
    </div>

    <p-table [scrollable]="true" scrollHeight="550px" scrollDirection="both" styleClass="mt-4 w-full" [value]="freightService.freightsList()" [loading]="freightService.isLoading()">
        <ng-template #caption>
            <div class="flex justify-between items-center flex-column sm:flex-row gap-3">
                <button pButton label="Agregar" icon="pi pi-plus" (click)="openDialogFreight()"></button>

                <p-iconfield iconPosition="left" class="ml-auto">
                    <p-inputicon>
                        <i class="pi pi-search"></i>
                    </p-inputicon>
                    <input pInputText type="text" placeholder="Buscar..." [(ngModel)]="searchTerm" />
                </p-iconfield>
            </div>
        </ng-template>

        <ng-template pTemplate="header">
            <tr>
                <th>Serial / Referencia</th>
                <th>Tipo</th>
                <th>Estado Flete</th>
                <th>Estado Pago</th>
                <th>Fecha Solicitada</th>
                <th>Unidades</th>
                <th>Tipo Carga</th>
                <th>Origen</th>
                <th>Destino</th>
                <th>Acciones</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-freight>
            <tr>
                <td>{{ freight.serialReference }}</td>
                <td>
                    <p-tag
                        [value]="freight.type === 'export' ? 'Exportación' : freight.type === 'import' ? 'Importación' : freight.type === 'internal' ? 'Interno' : 'Rescate'"
                        [severity]="freight.type === 'export' ? 'info' : freight.type === 'import' ? 'success' : 'warning'"
                    >
                    </p-tag>
                </td>
                <td>
                    <p-tag
                        [value]="
                            freight.freightStatus === 'pending'
                                ? 'Pendiente'
                                : freight.freightStatus === 'in_transit'
                                  ? 'En Tránsito'
                                  : freight.freightStatus === 'delayed'
                                    ? 'Retrasado'
                                    : freight.freightStatus === 'completed'
                                      ? 'Completado'
                                      : 'Cancelado'
                        "
                        [severity]="getStatusSeverity(freight.freightStatus)"
                    >
                    </p-tag>
                </td>
                <td>
                    <p-tag
                        [value]="freight.paymentStatus === 'pending' ? 'Pendiente' : freight.paymentStatus === 'paid' ? 'Pagado' : 'Vencido'"
                        [severity]="freight.paymentStatus === 'pending' ? 'warning' : freight.paymentStatus === 'paid' ? 'success' : 'danger'"
                    >
                    </p-tag>
                </td>
                <td>{{ freight.requestedDate | date: 'dd/MM/yyyy' }}</td>
                <td>{{ freight.requestedUnits }}</td>
                <td>{{ freight.cargoUnitType }}</td>
                <td>{{ freight.origin?.name || freight.originReference }}</td>
                <td>{{ freight.destination?.name || freight.destinationReference }}</td>
                <td class="text-center">
                    <p-button label="Opciones" severity="secondary" icon="pi pi-angle-down" iconPos="right" class="p-button-text p-button-ro" (click)="toggleMenu($event, freight)" />
                    <p-menu #menu [popup]="true" [model]="menuItems" [appendTo]="'body'"></p-menu>
                </td>
            </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
            <tr>
                <td colspan="10" class="text-center">No hay fletes registrados.</td>
            </tr>
        </ng-template>
    </p-table>

    <p-paginator
        [rows]="pageSize()"
        [first]="(freightService.paginationData().currentPage - 1) * pageSize()"
        [totalRecords]="freightService.paginationData().totalRecords"
        [rowsPerPageOptions]="[5, 10, 25, 100]"
        (onPageChange)="onPageChange($event)"
        styleClass="dark-paginator"
    ></p-paginator>
</div>

<p-dialog header="{{ editMode() ? 'Editar Flete' : 'Registrar Flete' }}" [(visible)]="dialogFreight" [modal]="true" [style]="{ width: '50vw' }" [breakpoints]="{ '960px': '90vw' }" [closable]="true" (onHide)="closeDialogFreight()">
    <form [formGroup]="freightForm" (ngSubmit)="onSubmitFreight()">
        <!-- Stepper personalizado -->
        <div class="stepper-container mb-4">
            <div class="stepper-nav">
                <div class="stepper-item" [class.active]="currentStep === 1" [class.completed]="currentStep > 1">
                    <div class="stepper-number">1</div>
                    <div class="stepper-title">Cliente</div>
                </div>
                <div class="stepper-separator"></div>
                <div class="stepper-item" [class.active]="currentStep === 2" [class.completed]="currentStep > 2">
                    <div class="stepper-number">2</div>
                    <div class="stepper-title">Carga</div>
                </div>
                <div class="stepper-separator"></div>
                <div class="stepper-item" [class.active]="currentStep === 3" [class.completed]="currentStep > 3">
                    <div class="stepper-number">3</div>
                    <div class="stepper-title">Origen y Destino</div>
                </div>
            </div>
        </div>

        <!-- Contenido de los pasos -->
        <div class="stepper-content">
            <!-- Paso 1: Datos del Cliente -->
            <div *ngIf="currentStep === 1" class="step-content">
                <h4 class="step-header">Datos del Cliente</h4>
                <div class="flex flex-col gap-4">
                    <div class="flex flex-wrap gap-4">
                        <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                            <label for="client" class="text-sm">Cliente <span class="text-red-500">*</span></label>
                            <p-dropdown id="client" formControlName="client" [options]="clients()" optionLabel="label" optionValue="value" placeholder="Seleccione un cliente" [showClear]="true" appendTo="body">
                                <ng-template pTemplate="header">
                                    <div class="p-2">
                                        <input type="text" pInputText placeholder="Buscar cliente..." [(ngModel)]="clientSearchTerm" (ngModelChange)="onClientSearchChange()" [ngModelOptions]="{ standalone: true }" class="w-full" />
                                    </div>
                                </ng-template>
                                <ng-template pTemplate="footer">
                                    <div class="p-2 border-t">
                                        <p-paginator [first]="(clientsPage() - 1) * clientsPageSize" [rows]="clientsPageSize" [totalRecords]="clientsTotalRecords()" (onPageChange)="onClientsPageChange($event)"></p-paginator>
                                    </div>
                                </ng-template>
                            </p-dropdown>
                        </div>
                        <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                            <label for="freightType" class="text-sm">Tipo de Flete <span class="text-red-500">*</span></label>
                            <p-dropdown id="freightType" formControlName="freightType" [options]="freightTypes" optionLabel="label" optionValue="value" placeholder="Seleccione tipo de flete" [showClear]="true" appendTo="body"></p-dropdown>
                        </div>
                    </div>
                    <div class="flex flex-wrap gap-4">
                        <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                            <label for="status" class="text-sm">Estado <span class="text-red-500">*</span></label>
                            <p-dropdown id="status" formControlName="status" [options]="freightStatuses" optionLabel="label" optionValue="value" placeholder="Seleccione estado" [showClear]="true" appendTo="body"></p-dropdown>
                        </div>
                        <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                            <label for="serialReference" class="text-sm">Serial / Referencia <span class="text-red-500">*</span></label>
                            <input pInputText id="serialReference" formControlName="serialReference" maxlength="25" placeholder="Ingrese serial o referencia" />
                        </div>
                    </div>
                    <div class="flex flex-wrap gap-4">
                        <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                            <label for="requestedDate" class="text-sm">Fecha Solicitada <span class="text-red-500">*</span></label>
                            <p-calendar id="requestedDate" formControlName="requestedDate" dateFormat="dd/mm/yy" [showIcon]="true" placeholder="Seleccione fecha"></p-calendar>
                        </div>
                    </div>
                </div>
                <div class="flex justify-end mt-4">
                    <button pButton label="Siguiente" icon="pi pi-arrow-right" iconPos="right" type="button" (click)="nextStep()"></button>
                </div>
            </div>

            <!-- Paso 2: Carga -->
            <div *ngIf="currentStep === 2" class="step-content">
                <h4 class="step-header">Información de Carga</h4>
                <div class="flex flex-col gap-4">
                    <div class="flex flex-wrap gap-4">
                        <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                            <label for="unitsRequired" class="text-sm">Nº unidades requeridas <span class="text-red-500">*</span></label>
                            <input pInputText id="unitsRequired" formControlName="unitsRequired" type="number" min="1" placeholder="Ingrese número de unidades" />
                        </div>
                        <div class="flex flex-col grow basis-0 gap-1 ´min-w-0">
                            <label for="cargoUnitType" class="text-sm">Tipo de unidad de carga <span class="text-red-500">*</span></label>
                            <p-dropdown id="cargoUnitType" formControlName="cargoUnitType" [options]="cargoUnitTypes" optionLabel="label" optionValue="value" placeholder="Seleccione tipo de unidad" [showClear]="true" appendTo="body"></p-dropdown>
                        </div>
                    </div>
                    <div class="flex flex-wrap gap-4">
                        <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                            <label for="cargoCondition" class="text-sm">Condición de la carga <span class="text-red-500">*</span></label>
                            <p-dropdown id="cargoCondition" formControlName="cargoCondition" [options]="cargoConditions" optionLabel="label" optionValue="value" placeholder="Seleccione condición" [showClear]="true" appendTo="body"></p-dropdown>
                        </div>
                    </div>
                    <div class="flex flex-col gap-1">
                        <label for="observations" class="text-sm">Observaciones</label>
                        <textarea pInputTextarea id="observations" formControlName="observations" rows="4" maxlength="250" placeholder="Ingrese observaciones adicionales (máximo 250 caracteres)"></textarea>
                        <small class="text-gray-500">{{ freightForm.get('observations')?.value?.length || 0 }}/250 caracteres</small>
                    </div>
                </div>
                <div class="flex justify-between mt-4">
                    <button pButton label="Anterior" icon="pi pi-arrow-left" type="button" (click)="previousStep()" class="p-button-secondary"></button>
                    <button pButton label="Siguiente" icon="pi pi-arrow-right" iconPos="right" type="button" (click)="nextStep()"></button>
                </div>
            </div>

            <!-- Paso 3: Origen y Destino -->
            <div *ngIf="currentStep === 3" class="step-content">
                <h4 class="step-header">Origen y Destino</h4>
                <div class="flex flex-col gap-4">
                    <!-- Origen -->
                    <div class="border border-gray-200 rounded-lg p-4">
                        <h5 class="text-base font-semibold text-gray-700 mb-3">Origen</h5>
                        <div class="flex flex-wrap gap-4">
                            <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                                <label for="originProvince" class="text-sm">Provincia de origen <span class="text-red-500">*</span></label>
                                <p-dropdown
                                    id="originProvince"
                                    [options]="provinces()"
                                    formControlName="originProvince"
                                    optionLabel="name"
                                    [optionValue]="'id'"
                                    placeholder="Seleccione provincia"
                                    [loading]="isLoading()"
                                    [showClear]="true"
                                    [filter]="true"
                                    [appendTo]="'body'"
                                    class="w-full custom-select"
                                    (onChange)="onProvinceOriginChange($event)"
                                ></p-dropdown>
                            </div>
                            <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                                <label for="originCity" class="text-sm">Ciudad de origen <span class="text-red-500">*</span></label>
                                <p-dropdown
                                    id="originCity"
                                    [options]="originCities()"
                                    formControlName="originCity"
                                    optionLabel="name"
                                    [optionValue]="'id'"
                                    placeholder="Seleccione ciudad"
                                    [showClear]="true"
                                    [appendTo]="'body'"
                                    [filter]="true"
                                    filterPlaceholder="Buscar ciudad"
                                    [loading]="isLoading()"
                                    class="w-full custom-select"
                                ></p-dropdown>
                            </div>
                        </div>
                        <div class="flex flex-wrap gap-4 mt-3">
                            <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                                <label for="originReference" class="text-sm">Referencia origen</label>
                                <input pInputText id="originReference" formControlName="originReference" placeholder="Dirección exacta, punto de referencia, etc." />
                            </div>
                            <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                                <label for="originDepot" class="text-sm">Depósito origen (opcional)</label>
                                <p-dropdown id="originDepot" formControlName="originDepot" optionLabel="label" optionValue="value" placeholder="Seleccione depósito" [showClear]="true"></p-dropdown>
                            </div>
                        </div>
                    </div>

                    <!-- Destino -->
                    <div class="border border-gray-200 rounded-lg p-4">
                        <h5 class="text-base font-semibold text-gray-700 mb-3">Destino</h5>
                        <div class="flex flex-wrap gap-4">
                            <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                                <label for="destinationProvince" class="text-sm">Provincia de destino <span class="text-red-500">*</span></label>
                                <p-dropdown
                                    id="destinationProvince"
                                    [options]="provinces()"
                                    formControlName="destinationProvince"
                                    optionLabel="name"
                                    [optionValue]="'id'"
                                    placeholder="Seleccione provincia"
                                    [loading]="isLoading()"
                                    [showClear]="true"
                                    [filter]="true"
                                    [appendTo]="'body'"
                                    class="w-full custom-select"
                                    (onChange)="onProvinceDestinChange($event)"
                                ></p-dropdown>
                            </div>
                            <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                                <label for="destinationCity" class="text-sm">Ciudad de destino <span class="text-red-500">*</span></label>
                                <p-dropdown
                                    id="destinationCity"
                                    [options]="destinationCities()"
                                    formControlName="destinationCity"
                                    optionLabel="name"
                                    [optionValue]="'id'"
                                    placeholder="Seleccione ciudad"
                                    [showClear]="true"
                                    [appendTo]="'body'"
                                    [filter]="true"
                                    filterPlaceholder="Buscar ciudad"
                                    [loading]="isLoading()"
                                    class="w-full custom-select"
                                ></p-dropdown>
                            </div>
                        </div>
                        <div class="flex flex-wrap gap-4 mt-3">
                            <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                                <label for="destinationReference" class="text-sm">Referencia destino</label>
                                <input pInputText id="destinationReference" formControlName="destinationReference" placeholder="Dirección exacta, punto de referencia, etc." />
                            </div>
                            <div class="flex flex-col grow basis-0 gap-1 min-w-0">
                                <label for="destinationDepot" class="text-sm">Depósito destino (opcional)</label>
                                <p-dropdown
                                    id="destinationDepot"
                                    [options]="depots()"
                                    [appendTo]="'body'"
                                    [filter]="true"
                                    filterPlaceholder="Buscar depósito"
                                    formControlName="destinationDepot"
                                    optionLabel="name"
                                    optionValue="id"
                                    placeholder="Seleccione depósito"
                                    [showClear]="true"
                                ></p-dropdown>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="flex justify-between mt-4">
                    <button pButton label="Anterior" icon="pi pi-arrow-left" type="button" (click)="previousStep()" class="p-button-secondary"></button>
                    <button pButton [label]="editMode() ? 'Actualizar' : 'Registrar'" icon="pi pi-save" type="submit"></button>
                </div>
            </div>
        </div>
    </form>
</p-dialog>

<!-- Diálogo de Detalles del Flete -->
<p-dialog header="Detalles del Flete" [(visible)]="dialogFreightDetails" [modal]="true" [style]="{ width: '80vw', maxWidth: '900px' }" [breakpoints]="{ '960px': '95vw' }" [closable]="true" (onHide)="dialogFreightDetails.set(false)">
    <div class="freight-details-report" *ngIf="selectedFreight">
        <!-- Header Section -->
        <div class="report-header mb-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <i class="pi pi-truck text-3xl text-primary"></i>
                    <div>
                        <h2 class="text-2xl font-bold text-gray-800 m-0">{{ selectedFreight.serialReference || 'Sin referencia' }}</h2>
                        <p class="text-gray-600 m-0">Cliente: {{ selectedFreight.id || 'No especificado' }}</p>
                    </div>
                </div>
                <p-tag
                    [value]="
                        getStatusSeverity(selectedFreight.freightStatus) === 'success'
                            ? 'Completado'
                            : getStatusSeverity(selectedFreight.freightStatus) === 'info'
                              ? 'En Tránsito'
                              : getStatusSeverity(selectedFreight.freightStatus) === 'warning'
                                ? 'Pendiente'
                                : 'Cancelado'
                    "
                    [severity]="getStatusSeverity(selectedFreight.freightStatus)"
                    class="text-lg px-3 py-2"
                ></p-tag>
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="progress-section mb-4">
            <h4 class="text-lg font-semibold mb-2">Progreso del Flete</h4>
            <p-progressBar [value]="getStatusProgress(selectedFreight.freightStatus)" [showValue]="false" styleClass="h-3"></p-progressBar>
            <div class="flex justify-between text-sm text-gray-600 mt-1">
                <span>Pendiente</span>
                <span>En Tránsito</span>
                <span>Completado</span>
            </div>
        </div>

        <!-- Main Content Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Información General -->
            <p-card header="Información General" class="shadow-sm">
                <div class="space-y-3">
                    <div class="flex items-center gap-3">
                        <i class="pi pi-calendar text-blue-500"></i>
                        <div>
                            <span class="font-medium">Fecha Solicitada:</span>
                            <p class="m-0 text-gray-700">{{ selectedFreight.requestedDate | date: 'dd/MM/yyyy' }}</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-3">
                        <i class="pi pi-tag text-green-500"></i>
                        <div>
                            <span class="font-medium">Tipo de Flete:</span>
                            <p class="m-0 text-gray-700">{{ getFreightTypeLabel(selectedFreight.type) }}</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-3">
                        <i class="pi pi-money-bill text-yellow-500"></i>
                        <div>
                            <span class="font-medium">Estado de Pago:</span>
                            <p-tag
                                [value]="selectedFreight.paymentStatus === 'pending' ? 'Pendiente' : selectedFreight.paymentStatus === 'paid' ? 'Pagado' : 'Vencido'"
                                [severity]="selectedFreight.paymentStatus === 'pending' ? 'warning' : selectedFreight.paymentStatus === 'paid' ? 'success' : 'danger'"
                            ></p-tag>
                        </div>
                    </div>
                </div>
            </p-card>

            <!-- Información de Carga -->
            <p-card header="Información de Carga" class="shadow-sm">
                <div class="space-y-3">
                    <div class="flex items-center gap-3">
                        <i class="pi pi-box text-purple-500"></i>
                        <div>
                            <span class="font-medium">Unidades Requeridas:</span>
                            <p class="m-0 text-gray-700">{{ selectedFreight.requestedUnits }}</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-3">
                        <i class="pi pi-cog text-orange-500"></i>
                        <div>
                            <span class="font-medium">Tipo de Unidad:</span>
                            <p class="m-0 text-gray-700">{{ getCargoUnitTypeLabel(selectedFreight.cargoUnitType) }}</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-3">
                        <i class="pi pi-shield text-red-500"></i>
                        <div>
                            <span class="font-medium">Condición de Carga:</span>
                            <p class="m-0 text-gray-700">{{ getCargoConditionLabel(selectedFreight.cargoCondition) }}</p>
                        </div>
                    </div>
                </div>
            </p-card>

            <!-- Origen -->
            <p-card header="Origen" class="shadow-sm">
                <div class="space-y-3">
                    <div class="flex items-start gap-3">
                        <i class="pi pi-map-marker text-red-500 mt-1"></i>
                        <div class="flex-1">
                            <span class="font-medium">Ciudad:</span>
                            <p class="m-0 text-gray-700">{{ getCityName(selectedFreight.originId) || 'No especificado' }}</p>
                        </div>
                    </div>
                    <div class="flex items-start gap-3" *ngIf="selectedFreight.originReference">
                        <i class="pi pi-info-circle text-blue-500 mt-1"></i>
                        <div class="flex-1">
                            <span class="font-medium">Referencia:</span>
                            <p class="m-0 text-gray-700">{{ selectedFreight.originReference }}</p>
                        </div>
                    </div>
                </div>
            </p-card>

            <!-- Destino -->
            <p-card header="Destino" class="shadow-sm">
                <div class="space-y-3">
                    <div class="flex items-start gap-3">
                        <i class="pi pi-map-marker text-green-500 mt-1"></i>
                        <div class="flex-1">
                            <span class="font-medium">Ciudad:</span>
                            <p class="m-0 text-gray-700">{{ getCityName(selectedFreight.destinationId) || 'No especificado' }}</p>
                        </div>
                    </div>
                    <div class="flex items-start gap-3" *ngIf="selectedFreight.destinationReference">
                        <i class="pi pi-info-circle text-blue-500 mt-1"></i>
                        <div class="flex-1">
                            <span class="font-medium">Referencia:</span>
                            <p class="m-0 text-gray-700">{{ selectedFreight.destinationReference }}</p>
                        </div>
                    </div>
                </div>
            </p-card>
        </div>

        <!-- Observaciones -->
        <p-card header="Observaciones" class="shadow-sm mt-6" *ngIf="selectedFreight.remarks || selectedFreight.cargoDescription">
            <div class="flex items-start gap-3">
                <i class="pi pi-comment text-gray-500 mt-1"></i>
                <div class="flex-1">
                    <p class="m-0 text-gray-700 whitespace-pre-line">{{ selectedFreight.remarks || selectedFreight.cargoDescription || 'Sin observaciones' }}</p>
                </div>
            </div>
        </p-card>
    </div>
</p-dialog>
